unit Demo01_MainForm;


interface



uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls,
  VFrames, Vcl.StdCtrls;

type
  TForm1 = class(TForm)
    PaintBox1: TPaintBox;
    Image1: TImage;
    Button1: TButton;
    Image2: TImage;
    procedure FormActivate(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
    fActivated : boolean;
    fVideoImage: TVideoImage;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}


procedure TForm1.FormCreate(Sender: TObject);
begin
  //PaintBox1.Align := alClient;
  fActivated      := false;

  // Create instance of our video image class.
  fVideoImage     := TVideoImage.Create;
  // Tell fVideoImage where to paint the images it receives from the camera
  // (Only in case we do not want to modify the images by ourselves)
  //fVideoImage.SetDisplayCanvas(PaintBox1.Canvas);
  fVideoImage.SetDisplayCanvas(Image1.Canvas);

  Caption := 'Demo01  [Initializing video...]';
end;




procedure TForm1.Button1Click(Sender: TObject);
begin
 Image1.Picture.SaveToFile('D:\abc.bmp');
 Image2.Picture:=Image1.Picture;
end;

procedure TForm1.FormActivate(Sender: TObject);
var
  DeviceList: TStringList;
begin
  IF fActivated then
    exit;
  fActivated := true;


  // Get list of available cameras
  DeviceList := TStringList.Create;
  fVideoImage.GetListOfDevices(DeviceList);


  IF DeviceList.Count < 1 then
    begin
      // If no camera has been found, terminate program
      Caption := 'Demo01  [No video device found]';
      MessageDlg('No video device found.'#10'Application will terminate.', mtError, [mbOK], 0);
      Application.Terminate;
      exit;
    end
    else begin
      // If at least one camera has been found, initialize first camera within the list
      fVideoImage.VideoStart(DeviceList[1]);
      Caption := 'Demo01  ['+DeviceList[1]+']';
    end;
end;



procedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  fVideoImage.VideoStop;
end;

end.
